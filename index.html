<!DOCTYPE html>
<html>
<head>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/jeromeetienne/ar.js@2.2.1/aframe/build/aframe-ar.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/nicolocarpignoli/nicolocarpignoli.github.io/ar-click-events/events.js"></script>

    <script>
        AFRAME.registerComponent('custom-markerhandler', {
            init: function () {
                const animatedMarker = document.querySelector("#marker");
                const aEntity = document.querySelector("#model");

                if (!animatedMarker || !aEntity) {
                    console.error("Marker or model entity not found");
                    return;
                }

                animatedMarker.addEventListener('click', function (ev) {
                    const intersectedElement = ev?.detail?.intersectedEl;
                    console.log(intersectedElement);
                    if (aEntity && intersectedElement === aEntity) {
                        const scale = aEntity.getAttribute('scale');
                        Object.keys(scale).forEach((key) => {
                            scale[key] = parseFloat(scale[key]) + 1;
                        });
                        aEntity.setAttribute('scale', scale);
                    }
                });
            }
        });
    </script>
</head>
<body style="margin: 0; overflow: hidden;">
    <a-scene embedded arjs="debugUIEnabled: false;" vr-mode-ui="enabled: false">
        <a-marker custom-markerhandler id="marker"     cursor="rayOrigin: mouse; raycaster: objects: [data-raycastable]"
            emitevents="true" cursor="rayOrigin: mouse" preset="custom" type="pattern"
            url="qr-pattern.patt" smooth="true" smoothCount="10" smoothTolerance="0.01" smoothThreshold="2">
            <!-- <a-entity id="model" gltf-model="Pathfinder_2k.glb" scale="1"></a-entity> -->
            <a-box id="model" position="5 0.5 0" material="color: red;" data-raycastable></a-box>

        </a-marker>
        <a-entity camera></a-entity>
    </a-scene>
</body>
</html>
